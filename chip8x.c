typedef unsigned char u8;typedef unsigned short u16;u8 m[4096],v[16],d[2048],k[16],dt,st,f[]={240,144,144,144,240,32,96,32,32,112,240,16,240,128,240,240,16,240,16,240,144,144,240,16,16,240,128,240,16,240,240,128,240,144,240,240,16,32,64,64,240,144,240,144,240,240,144,240,16,240,240,144,240,144,144,224,144,224,144,224,240,128,128,128,240,224,144,144,144,224,240,128,240,128,240,240,128,240,128,128};u16 pc=512,i,s[16],sp,ks[]={120,49,50,51,113,119,101,97,115,100,122,99,52,114,102,118};void*XOpenDisplay();void*XCreateGC();void*fopen();main(int a,char**b){void*y=XOpenDisplay(0);unsigned long w=XCreateSimpleWindow(y,XRootWindow(y,0),0,0,640,320,0,0,0);XSelectInput(y,w,3);XMapWindow(y,w);void*g=XCreateGC(y,w,0,0);long t[2],n[2];gettimeofday(t,0);void*p=fopen(b[1],"rb");if(!p)return 1;fread(m+512,1,3584,p);memcpy(m,f,80);for(;;usleep(1200)){while(XPending(y)){u8 e[256];XNextEvent(y,e);for(int j=0;j<16;j++)if(XLookupKeysym(e,0)==ks[j])k[j]=(*(int*)e==2);}u16 o=m[pc]<<8|m[pc+1],x=o>>8&15,y2=o>>4&15,nnn=o&4095,nn=o&255,n4=o&15;pc+=2;switch(o>>12){case 0:if(o==224)memset(d,0,2048);if(o==238)pc=s[--sp];break;case 1:pc=nnn;break;case 2:s[sp++]=pc,pc=nnn;break;case 3:if(v[x]==nn)pc+=2;break;case 4:if(v[x]!=nn)pc+=2;break;case 5:if(v[x]==v[y2])pc+=2;break;case 6:v[x]=nn;break;case 7:v[x]+=nn;break;case 8:switch(n4){case 0:v[x]=v[y2];break;case 1:v[x]|=v[y2];break;case 2:v[x]&=v[y2];break;case 3:v[x]^=v[y2];break;case 4:v[15]=v[x]+v[y2]>255,v[x]+=v[y2];break;case 5:v[15]=v[x]>v[y2],v[x]-=v[y2];break;case 6:v[15]=v[x]&1,v[x]>>=1;break;case 7:v[15]=v[y2]>v[x],v[x]=v[y2]-v[x];break;case 14:v[15]=v[x]>>7,v[x]<<=1;break;}break;case 9:if(v[x]!=v[y2])pc+=2;break;case 10:i=nnn;break;case 11:pc=nnn+v[0];break;case 12:v[x]=(rand()%256)&nn;break;case 13:v[15]=0;for(int h=0;h<n4;h++){u8 l=m[i+h];for(int z=0;z<8;z++)if(l&(128>>z)){int a=((v[x]+z)%64)+((v[y2]+h)%32)*64;if(d[a])v[15]=1;d[a]^=1;}}break;case 14:if(nn==158&&k[v[x]])pc+=2;if(nn==161&&!k[v[x]])pc+=2;break;case 15:switch(nn){case 7:v[x]=dt;break;case 10:{int f2=0;for(int j=0;j<16;j++)if(k[j]){v[x]=j,f2=1;break;}if(!f2)pc-=2;}break;case 21:dt=v[x];break;case 24:st=v[x];break;case 30:i+=v[x];break;case 41:i=v[x]*5;break;case 51:m[i]=v[x]/100,m[i+1]=(v[x]/10)%10,m[i+2]=v[x]%10;break;case 85:for(int j=0;j<=x;j++)m[i+j]=v[j];break;case 101:for(int j=0;j<=x;j++)v[j]=m[i+j];break;}break;}gettimeofday(n,0);if((n[1]-t[1]+1000000*(n[0]-t[0]))>16666){if(dt>0)dt--;if(st>0)st--;XClearWindow(y,w);XSetForeground(y,g,16777215);for(int j=0;j<2048;j++)if(d[j])XFillRectangle(y,w,g,(j%64)*10,(j/64)*10,10,10);XFlush(y),t[0]=n[0],t[1]=n[1];}}}
